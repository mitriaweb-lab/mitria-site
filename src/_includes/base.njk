<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% if title and title != "Home" %}{{ title }} — {% endif %}{{ site.name }}</title>
  <meta name="description" content="{{ description or site.tagline }}">
  <meta property="og:title" content="{% if title and title != 'Home' %}{{ title }} — {% endif %}{{ site.name }}">
  <meta property="og:description" content="{{ description or site.tagline }}">
  <meta property="og:type" content="website">
  <meta property="og:image" content="/images/logo.svg">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="{% if title and title != 'Home' %}{{ title }} — {% endif %}{{ site.name }}">
  <meta name="twitter:description" content="{{ description or site.tagline }}">
  <link rel="icon" href="/images/logo.svg" type="image/svg+xml">
  <link rel="stylesheet" href="/styles.css">
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>

  <nav class="nav" id="nav">
    <div class="nav__inner">
      <a href="/" class="nav__logo"><img src="/images/logo.svg" alt="Mitria"></a>
      <button class="nav__toggle" id="navToggle" aria-label="Toggle menu">
        <span></span><span></span><span></span>
      </button>
      <ul class="nav__links" id="navLinks">
        <li><a href="/about/"{% if page.url == '/about/' %} class="active"{% endif %}>About</a></li>
        <li><a href="/experiences/"{% if page.url == '/experiences/' %} class="active"{% endif %}>Experiences</a></li>
        <li><a href="/projects/"{% if page.url == '/projects/' %} class="active"{% endif %}>Projects</a></li>
        <li><a href="/countries/"{% if '/countries/' in page.url %} class="active"{% endif %}>Countries</a></li>
        <li><a href="/blog/"{% if '/blog/' in page.url %} class="active"{% endif %}>Blog</a></li>
        <li><a href="/contact/" class="nav__cta{% if page.url == '/contact/' %} active{% endif %}">Contact Us</a></li>
      </ul>
    </div>
  </nav>

  {{ content | safe }}

  {% if showCta !== false %}
  <section class="cta-banner">
    <h2>{{ ctaTitle or "Let's plan something meaningful" }}</h2>
    <p>{{ ctaText or "Whether you want to join a trip, build a custom itinerary, or get involved in a project, we're here." }}</p>
    <a href="/contact/" class="btn btn--outline">Get in Touch</a>
  </section>
  {% endif %}

  <footer class="footer">
    <div class="container">
      <div class="footer__inner">
        <div class="footer__brand">
          <a href="/" class="nav__logo"><img src="/images/logo.svg" alt="Mitria"></a>
          <p>{{ site.tagline }}</p>
        </div>
        <div>
          <h4>Explore</h4>
          <ul class="footer__links">
            <li><a href="/experiences/">Experiences</a></li>
            <li><a href="/projects/">Projects</a></li>
            <li><a href="/countries/">Countries</a></li>
            <li><a href="/blog/">Blog</a></li>
          </ul>
        </div>
        <div>
          <h4>Company</h4>
          <ul class="footer__links">
            <li><a href="/about/">About Us</a></li>
            <li><a href="/contact/">Contact</a></li>
          </ul>
        </div>
      </div>
      <div class="footer__bottom">
        <span>&copy; 2025 {{ site.name }}. All rights reserved.</span>
        <div class="footer__social">
          <a href="{{ site.facebook }}">Facebook</a>
          <a href="{{ site.instagram }}">Instagram</a>
        </div>
      </div>
    </div>
  </footer>

  <script>
    const toggle = document.getElementById('navToggle');
    const links = document.getElementById('navLinks');
    toggle.addEventListener('click', () => links.classList.toggle('open'));
    document.querySelectorAll('.nav__links a').forEach(l => l.addEventListener('click', () => links.classList.remove('open')));
    window.addEventListener('scroll', () => document.getElementById('nav').classList.toggle('nav--scrolled', window.scrollY > 10));
    // Lazy load all images except first hero
    document.querySelectorAll('img:not(.hero__image)').forEach(img => { img.loading = 'lazy'; img.decoding = 'async'; });
    // Parallax for Zomia intro
    (function() {
      var hornbill = document.querySelector('.zomia-intro__hornbill');
      var statNum = document.querySelector('.zomia-intro__number');
      if (!hornbill || !statNum) return;
      var prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      if (prefersReduced) return;
      function onScroll() {
        var rect = hornbill.closest('.zomia-intro').getBoundingClientRect();
        var vh = window.innerHeight;
        if (rect.top < vh && rect.bottom > 0) {
          var progress = (vh - rect.top) / (vh + rect.height);
          var offset = (progress - 0.5) * 40;
          hornbill.style.transform = 'translateY(' + offset + 'px) rotate(' + (offset * 0.3) + 'deg)';
          statNum.style.transform = 'translateY(' + (offset * -0.5) + 'px)';
        }
      }
      var ticking = false;
      window.addEventListener('scroll', function() {
        if (!ticking) { requestAnimationFrame(function() { onScroll(); ticking = false; }); ticking = true; }
      }, { passive: true });
    })();
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("init", user => {
        if (!user) { window.netlifyIdentity.on("login", () => { document.location.href = "/admin/"; }); }
      });
    }
  </script>

</body>
</html>
